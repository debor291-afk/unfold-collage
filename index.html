<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Unfold-style Collage (PWA)</title>
  <link rel="manifest" href="./manifest.webmanifest">
  <meta name="theme-color" content="#0b0b0c" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="apple-touch-icon" href="./icons/icon-180.png">
  <link rel="icon" sizes="192x192" href="./icons/icon-192.png">
  <link rel="icon" sizes="512x512" href="./icons/icon-512.png">
  <style>
    body{margin:0;font-family:sans-serif;background:#111;color:#eee}
    h1{font-size:18px}
    .stage{position:relative;width:90vw;aspect-ratio:9/16;background:#000;margin:20px auto;overflow:hidden;border-radius:12px}
    .item{position:absolute;top:20px;left:20px;cursor:move}
    .crop-modal{position:fixed;inset:0;background:rgba(0,0,0,.7);display:none;align-items:center;justify-content:center;z-index:50;touch-action:none;overscroll-behavior:none}
    body.lock{position:fixed;width:100%;overflow:hidden;touch-action:none}
  </style>
</head>
<body>
  <h1>Unfold-style Collage (PWA demo)</h1>
  <div class="stage" id="stage"></div>

  <div id="cropModal" class="crop-modal">
    <div style="background:#222;padding:20px;border-radius:12px;color:#fff">Кадрирование…</div>
  </div>

  <script>
    // Register service worker
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', ()=> navigator.serviceWorker.register('./service-worker.js').catch(console.error));
    }

    const cropModal=document.getElementById('cropModal');
    function openCrop(){
      document.body.classList.add('lock');
      cropModal.style.display='flex';
    }
    function closeCrop(){
      cropModal.style.display='none';
      document.body.classList.remove('lock');
    }
    // demo: открываем кроп через 2с и закрываем через 4с
    setTimeout(openCrop,2000);
    setTimeout(closeCrop,6000);
  </script>
</body>
</html>
